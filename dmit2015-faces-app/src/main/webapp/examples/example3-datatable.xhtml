<!-- This is a Faces composition page that extends the layout template -->
<ui:composition
        template="/WEB-INF/faces-templates/layout.xhtml"
        xmlns:ui="jakarta.faces.facelets"
        xmlns:h="jakarta.faces.html"
        xmlns:f="jakarta.faces.core"
        xmlns:p="primefaces"
        xmlns:o="http://omnifaces.org/ui">

    <!-- Page metadata for title, description, and keywords -->
    <ui:param name="title" value="example3-datatable"/>

    <!-- Define main content for the page -->
    <ui:define name="maincontent">
        <div class="card">
            <h1 role="heading" aria-level="1">Example 3 – InputText, DataTable, and CommandButton </h1>
            <h:form id="example3-datatable_form" role="form">
                <p:panel header="Welcome to Example 3 – InputText, DataTable, and CommandButton ">
                    <!-- Add page-specific content here, e.g., PrimeFaces components -->
                    <div class="field">
                        <p:outputLabel for="@next">Task</p:outputLabel>
                        <p:inputText id="description"
                                     value="#{example3DataTableView.newTask.description}"
                        />
                        <p:message for="description" />
                    </div>
                    <div class="field">
                        <p:outputLabel for="@next">Priority</p:outputLabel>
                        <p:selectOneMenu id="priority"
                                         value="#{example3DataTableView.newTask.priority}">
                            <f:selectItem itemLabel="-- select priority --" itemValue="" />
                            <f:selectItem itemLabel="Low" itemValue="Low" />
                            <f:selectItem itemLabel="Medium" itemValue="Medium" />
                            <f:selectItem itemLabel="High" itemValue="High" />
                        </p:selectOneMenu>
                    </div>

                    <p:commandButton id="addTaskButton"
                                     value="Add Task"
                                     actionListener="#{example3DataTableView.onSubmitAddTask()}"
                                     update="@form:taskTable @form:description"
                                     />

                    <p:dataTable id="taskTable"
                                value="#{example3DataTableView.tasks}"
                                 var="currentTask">
                        <p:column headerText="Task">
                            <h:outputText value="#{currentTask.description}" />
                        </p:column>
                        <p:column headerText="Priority">
                            <h:outputText value="#{currentTask.priority}" />
                        </p:column>
                        <p:column headerText="Done">
                            <p:selectBooleanCheckbox value="#{currentTask.done}" >
                                <p:ajax listener="#{example3DataTableView.onDoneTask(currentTask)}"
                                        process="@this"
                                        update="@form:taskTable @form:completedTaskTable"
                                />
                            </p:selectBooleanCheckbox>
                        </p:column>
<!--                        <p:column headerText="Action">-->
<!--                            <p:commandButton value="Done"-->
<!--                                             actionListener="#{example3DataTableView.onDoneTask(currentTask)}"-->
<!--                                             update="@form:taskTable @form:completedTaskTable"-->
<!--                                             process="@this"-->
<!--                                             >-->
<!--                            </p:commandButton>-->
<!--                        </p:column>-->
                    </p:dataTable>

                    <p:dataTable id="completedTaskTable"
                                 value="#{example3DataTableView.completedTasks}"
                                 var="currentTask">
                        <p:column headerText="Task" >
                            <h:outputText value="#{currentTask.description}"
                                          style="text-decoration: line-through; color: red;"/>
                        </p:column>
                        <p:column headerText="Priority" >
                            <h:outputText value="#{currentTask.priority}" />
                        </p:column>
                        <p:column headerText="Done">
                            <p:selectBooleanCheckbox value="#{currentTask.done}" >
                                <p:ajax listener="#{example3DataTableView.onUndoneTask(currentTask)}"
                                        process="@this"
                                        update="@form:completedTaskTable @form:taskTable"
                                />
                            </p:selectBooleanCheckbox>
                        </p:column>
                        <p:column headerText="Action">
<!--                            <p:commandButton value="Undone"-->
<!--                                             actionListener="#{example3DataTableView.onUndoneTask(currentTask)}"-->
<!--                                             update="@form:completedTaskTable @form:taskTable"-->
<!--                                             process="@this"-->
<!--                                             />-->
                            <p:commandButton value="delete"
                                             styleClass="ui-button-danger"
                                             actionListener="#{example3DataTableView.onRemoveTask(currentTask)}"
                                             update="@form:completedTaskTable"
                                             process="@this"
                            >
                                <p:confirm type="popup"
                                           header="Confirmation"
                                           message="Are you sure you want to delete this record?"
                                           icon="pi pi-exclamation-triangle"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                    <p:confirmPopup global="true">
                        <p:commandButton value="No" type="button" styleClass="ui-confirm-popup-no ui-button-flat" icon="pi pi-times"/>
                        <p:commandButton value="Yes" type="button" styleClass="ui-confirm-popup-yes" icon="pi pi-check"/>
                    </p:confirmPopup>
                </p:panel>
            </h:form>
        </div>
    </ui:define>

</ui:composition>